# Automatically generated on 2022-11-13 UTC from https://codemagic.io/app/605db039ca9e14838fe78a43/settings
# Note that this configuration is not an exact match to UI settings. Review and adjust as necessary.

workflows:
  default-workflow:
    name: Default Workflow
    max_build_duration: 60
    environment:
      groups:
        - app_store_credentials
      vars:
        APP_STORE_CONNECT_ISSUER_ID: 781f963c-32fa-4072-9272-dee7269065d3
        APP_STORE_CONNECT_KEY_IDENTIFIER: BHMC3M34X6
        APP_STORE_CONNECT_PRIVATE_KEY: Encrypted(Z0FBQUFBQmpjVkVtaFU4ckgtNlFQRjRmNXJONkVGendJTkJlZ1FzOUdFVzBZNENvNDFheWUwbG1WUXJNUTEwR1ZlMURNMWh6b2xha0U4aEc1R1ZkXzNVeVI2LThIM1Z5WVFZYmFGTjJLMmZoM3lEYnJ5aHkyMUV2UU1YMndhZC1QaGV6STRrZkkwVGdoei04NmdwUkpDZGo3VVFlTWhUMEtWb2I2d3NmWGcyRFlzd1F5bHlOLVFNZURrZ1pERjUzRFVLZThJZFMwRlRXWXUxWEdReGk3YU56T1FndDRzSGZrTXpreHd3blBFREMwZTZqZGpoTGlRaW5lQWhPX1dURmlIM0xUME1DT3dPWDlORGF0SnhleDh2SUg4TXZ5ckNZdW1ZNk0zaEREeTMyNjRkOElSUHFxcjVUYXF6aXNJN0NYVTZKaEd2U0x2YzM0emtsZDFidXRUVWdKenJqeUxyT0F6UU1KcDE1Rk9YdlhvVTdNaU4xQ3lyYjl6cGxmNFVfTE9Zejd0dko2bGkyeU4yLTZIeHotXzRLSndPQXNpTUxvUWNZQ3hpUklMVTVVa25OVzd5enZ2Yz0=)
        CERTIFICATE_PRIVATE_KEY: Encrypted(Z0FBQUFBQmpjVkVtTGhXd2drR2J1am8zNXB4T3BsTzU2b2F5UzE5cXliVU50N2htaExTc0NQNFRYblZaOUUwaG1OTnhrMnIyamhpWFlNa0NIdFpXbEdycFZEY3IzOEJtcHZ4YUVoVDBNVVRUb21BejdGaHVTSnFYamRDdnNuQURiVUZ2OUdGcXZWYmJTZElIdjVQNjNNNlQ0cV8wWEh1dGJNbEtGNDlGbGNwN2pEQm40Y21hclBkenFPOUs2Mi1GcXo3OHVSRzNjQkJVUGM2UnJZWUpoak92cXA1ODgwZWN2ZVJUeFZvVU9qaTk4ZVkxY0NUN290cjFhNWJlal9YcTZmbXJvRC1hcWhGRFAwVHp1WVVjZmFUUzV2NGpsMUU4Ym9GRGdiTjBqMm15cGdMRnk4ay1ZNUtYMWI2eDRIRlZ3ZWp1WU9mZ0FRZmZLdWNxM3BDakZqY2lfTFh5aFJINHdkdGNXNXhGVFNHd3dMZjFIZkhlaWhTN2RPWVdoblAxcVNoYl9pNmlNSTJJN204TkV3eVZycmFQMkxoMHRxNTJZZVFxR190VEJGTXhQOGh3MXZxbkhHOWpraVJXUllxNFhTbXhzRzhRcDhvRktuMWJfVDRqaEg4ZEVwVzNyb1piWFlRTUJiVk9KaUFoX2hmRXNCaUJIUUZtdU9uSlJCQW5DOVB3MFpiV2xjcTZaM2d5VWhKVTF6MU9heEszVkN3VVpWejVuNHNEWWRzbDQwNzdwZUVldy1LTnBlSWdkazVrN3U5bVRhV1A4bnBFd3lDY0JPM2RSV1ZwODdGaXRONEQ5VmhvSHl2WXZvekVmRThLQ29CUXVnZkNaOEk0NDVJN0Qydk1iblNZVjBsRnlEZFp6eml3QXlkbzZLc3Yzc2NUUms2bndZaldVOUc5ZlNtel9JLThpYnNJV3d1cXhHSUdKWUx3bG9hbmhlZVlWQTlGX0owWDM1R2dNbDB2TzRwWHRJRWdLT0MxRDlkNjNFUGxqRHRHcWxwOW02dkdLVFNzRDUzbnlRN2JsNExJMnNvUEtZUkxrNnJra0RXbUpISW1uZXFBeGMyZWNvaDRZN0xNOXVDVXVqMWhaeHRkWWI3MzRLQVoxN21keTZWZHJCRE9TMC16a2ptSVp5ZnctX3h5Zjc0cE9jdWNxZEJ0SWxNellNdEEyZm1jZUExS2JCMzAwTG04a0xkTHZyOW4zeUROOVZFTnlMYlpMZVdOOXVrWG1uN3FDSmR1Z05oaHlsLThyYXdWOUFzSWdwb21mWE9uUm4tc2lZMnpaYXBtQWdzQko2bklaWW9pS3ZwVW9EV05ZbXlMUDF3c2o5cGdmS0dvdXN5bkRlX1JVZjR6d1Z1dkJzaFdDMWJnWUxaY2d4S2lFenJXQ1VxTllFcGthQk5LVmJzZnJUWWxGRW8yUG5YVnhubm9nUGh3WUJVOGl6RmxuRTl3ZEJYdS13TWJDajh3aDRGMFprTDNVNWJ3Q1VVa205eVFEWF8zSURBUjk0YXlCS0ZRZFAyOXREc2RBaGRraXYzMFJWRnZZc2RQeUszZ08tUlhZNTBGTzkzcHZ1SUtkRlRlSVdLWFFwbHNkSy04RV9DODdWamhjTm01c1kwSFlZbTAwTnFDRTNacGRMaDRLeE1DM1pIcTZkbVlBTTA4QjIxOTU5VnYtNXpQQUpfbWhvTm04dktfR1cyY2g4cFUwVzNsT1hSYkhFbE41YUtKLTFyclV4VUp1Z2Vua3k2NDk2RUVJelZkYVRCaE53eDNCQlZGRGNRb0ZjQ00wY25MWWhMV2ZQQ1YyTW1sU0Ixam9CT1lBSElkZFQ3ZFNaSWhPelBqNDNpaHN4dnplQ2Fpd3B4VUJ4OEh4Y3JWNWpaUEZQWFNWZEk2YkE4N0w1aTBreUMzTTZWZTBTV1BXY2YyWWJpVjlFcUNVRTlzc1JHVkE4Sl80WHE2Q0hzZ0NmdlRRbVBpM25LODFlSEt2cFl5QzNjQ1YzYm5sdmc5SkxfQVNIek1xMzdNTlVjdk5XTG9PQUxMMXpHYkJ5d2VBc2VjazFPdHdLRTFOYUpJUk5KeTF1YnNuc2FaNFNub3VMZzVEeWN4TzFDRlY1VzVydEJLUEVzc21CbnVNWUNLRzAyQ3VCemdITlJDd1NsdERDVXR0TjN4WWFDdWY0N2N3SXFpeDQ3aW9pa1hMU2pmWUpkejBlcV9GYmFLelBDdndNS3E4ZW9kNl9MQmlWNFBHVkcxNDZFVlRhaUliUHJZbV9xX3l1SDdDMGExTnBSODNXTTdGTnNBcWE3Tm5UMTdyalczUXg4UXFlZnpnTm1vbHM4SV83U1ZqbkMxWTdjZ0FDY2pqQl9oWDdFVHhmZWJaWFBPbnpRY29DN0k5RVphYm1KSHVxMnZIbW92eHlrd05KZ0NSTUpHSVAwQjNDUDlzaTJKSDEtSjBNWmo5TkxrRTNMZ05EaW53ZjZ5YllRb0ozNnFKbUo3cnlFM3BZNXk2YXFhNGNqdnlKeWxlYmJyYUlqYk5NUW1YalhHN0FGblA4d0JrMHZFRnl0enpWZFNLV3M4MHBYWGVpcTBKZGwzQlNpbFE0T2wwRUJOUzhQTnJyNVVKbUhLRnJBaVRlMTkxbE9CSVB6T2VBcExCUVltbjgxVWtjVWNFMVY0TGdHc0xfNGlMOURla09GdGc1SnNGQjBVUDNtNmNPVUlwSk9FS2NPRVZBWlNNMXF5cW9iR1RrUGxtaGlWdlVvMFh1RUpjY202QU5sa0Nud0ZpSXY2MXN4TmY3UVc0V2pORVFvZF9ic3p1aHR4Qm9ZRjF1akVXcWNZUkpndUs5RDNPWTlrLWNhMzdmSVA4UDlZSWEzZGx5Q2lBZ042RVNXMmFMUmNSdFFDb1oyZ1pJV0ttMXVyVkY4OEowWnNoUVNmaWNyY3hfX1JSS2FXUzQxUnR5OHJyVDZ2UHBFVVQ1NVhzMTVhcEltcG10dkVlU0t4RV9ua3pJcVVUaXJscjNyVHBBRnk0NXNwOEVCeW82UTl1cTU2WFViOVVOc3Bjd01vRVV0R3IwaWtNeHR0UnRMNmtSaTlhUm94VU9MUGg5UjZJb1JG)
      flutter: stable
      xcode: latest
      cocoapods: default
    triggering:
      events:
        - push
      branch_patterns:
        - pattern: '*'
          include: true
          source: true
      tag_patterns:
        - pattern: start-codemagic-build
          include: true
    scripts:
      - name: Get the latest build number
        script: | 
          LATEST_BUILD_NUMBER=$(app-store-connect get-latest-app-store-build-number "$APP_APPLE_ID")
          cd ./ios # avgtool must run in the folder where xcodeproj file is located
          agvtool new-version -all $(($LATEST_BUILD_NUMBER + 1))
      - flutter packages pub get
      - find . -name "Podfile" -execdir pod install \;
      - keychain initialize
      - app-store-connect fetch-signing-files "com.ruslan.myspygame" --type IOS_APP_STORE
        --create
      - keychain add-certificates
      - xcode-project use-profiles
      - flutter build ipa --export-options-plist ~/export_options.plist 
      
      
    artifacts:
      - build/ios/ipa/*.ipa
      - /tmp/xcodebuild_logs/*.log
      - '*.snap'
      - build/windows/**/*.msix
      - flutter_drive.log
    publishing:
      email:
        recipients:
          - 95baes@gmail.com
      app_store_connect:
        api_key: Encrypted(Z0FBQUFBQmpjVkVtcW5veEJfYzBvNVg1bkZYcU5OYS1hd0Z0Rm15M0E0NkdlQTIxdldKamkwVG5tNi1lWHl5dEpQbUFiRkRCWWhfQ1VSbnpMeGRTWUEyWmpUVXFFWlh4Nk91cXlrcmpEdDZFNVdFMC01WkNKaTJQYjJMX0tsaHh1RldxZ2hNZFNsSFNGT1RfNXZKcmJmWjlTVXFWNXozOUw5QjZfN19TQ09XVnM3Mm9xVnh6Sk5LcW9JbXozbWdOOU5ldFlxMkxJZWNfbjNOX0lVSFFPNEx3aW1acmw3Slg0Y3Y3RnQzUnl4TG1FUnpDWHJrTWhGdS15eFpUYWEwZDZfWmJ0ZzRSbzhmS1UyX01LRFpmR201d2pjZmxSaXE2Ykg1NFJiSlVNZjRmVHJwaFQ0TmtoQUNWZTROWnFDSC1HOWtHcnpqUDBkTzNYdGxHUzMxeFBMZURqTVBjZ1FxUkdpTVFXNlJIZUotV3gwck9SVUhSeENZeWY3YXJKekJIXzFWYVM4STI4YWhka3U0cHR1cmVIOGxQckNCSWdNVG5odUVIYThHajVCQnNWTHZGMVZzWWNuTT0=)
        key_id: BHMC3M34X6
        issuer_id: 781f963c-32fa-4072-9272-dee7269065d3
        submit_to_testflight: true
        submit_to_app_store: false
